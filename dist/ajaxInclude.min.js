/*! Ajax-Include - v0.1.1 - 2012-11-27
* http://filamentgroup.com/lab/ajax_includes_modular_content/
* Copyright (c) 2012 @scottjehl, Filament Group, Inc.; Licensed MIT */
(function(e,t){e.fn.ajaxInclude=function(t){function u(t){var n=t.data("url");o.proxy&&e.inArray(n,r)===-1?(r.push(n),i=i.add(t)):a(t.data("url"),t)}function a(t,n){e.get(t,function(e){n.trigger("ajaxIncludeResponse",[e])})}function f(){r.length&&(a(o.proxy+r.join(","),i),i=e(),r=[])}function l(e,t){function i(){u(e),f(),r.removeListener(i)}var r=n.matchMedia(t);r.addListener&&r.addListener(i)}function c(e){e.on("click",function(t){u(e),e.off("click")})}var n=window,r=[],i=e(),s="data-ajax-bound",o={proxy:null};return typeof t=="string"?o.proxy=t:o=e.extend(o,t),this.not("["+s+"]").each(function(t){var r=e(this),i=r.attr("data-media"),a=["append","replace","before","after"],f,h;for(var p=a.length,d=0;d<p;d++)r.is("[data-"+a[d]+"]")&&(f=a[d],h=r.attr("data-"+f));f==="replace"&&(f+="With"),r.data("method",f).data("url",h).attr(s,!0).bind("ajaxIncludeResponse",function(e,t){var n=t;if(o.proxy){var i=n.match(new RegExp("<entry url=[\"']?"+r.data("url")+"[\"']?>(?:(?!</entry>)(.|\n))*","gmi"));i&&(n=i[0])}var s=r.triggerHandler("ajaxIncludeFilter",[n]);s&&(n=s),f==="replaceWith"?r.trigger("ajaxInclude",[n])[r.data("method")](n):r[r.data("method")](n).trigger("ajaxInclude",[n])}),o.onManualCall===!0&&(c(r),r.on("click","a",function(e){e.preventDefault()})),!i||n.matchMedia&&n.matchMedia(i).matches?u(r):i&&n.matchMedia&&o.onOrientationChange!==!1&&l(r,i)}),f(),this}})(jQuery);