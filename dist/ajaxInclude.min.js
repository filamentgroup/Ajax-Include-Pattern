/*! Ajax-Include - v0.1.1 - 2012-11-27
* http://filamentgroup.com/lab/ajax_includes_modular_content/
* Copyright (c) 2012 @scottjehl, Filament Group, Inc.; Licensed MIT */
(function(e,t){e.fn.ajaxInclude=function(t,n){function a(t){var n=t.data("url");u.proxy&&e.inArray(n,i)===-1?(i.push(n),s=s.add(t)):f(t.data("url"),t)}function f(t,r){e.get(t,function(e){r.trigger("ajaxIncludeResponse",[e]),n&&n()})}function l(){i.length&&(f(u.proxy+i.join(","),s),s=e(),i=[])}function c(e,t){function i(){a(e),l(),n.removeListener(i)}var n=r.matchMedia(t);n.addListener&&n.addListener(i)}function h(e){e.one("click",function(t){a(e)})}var r=window,i=[],s=e(),o="data-ajax-bound",u={proxy:null};return typeof t=="string"?u.proxy=t:typeof t=="function"?n=t:u=e.extend(u,t),this.not("["+o+"]").each(function(t){var n=e(this),i=n.attr("data-media"),s=["append","replace","before","after"],f,l;for(var p=s.length,d=0;d<p;d++)n.is("[data-"+s[d]+"]")&&(f=s[d],l=n.attr("data-"+f));f==="replace"&&(f+="With"),n.data("method",f).data("url",l).attr(o,!0).bind("ajaxIncludeResponse",function(e,t){var r=t;if(u.proxy){var i=r.match(new RegExp("<entry url=[\"']?"+n.data("url")+"[\"']?>(?:(?!</entry>)(.|\n))*","gmi"));i&&(r=i[0])}var s=n.triggerHandler("ajaxIncludeFilter",[r]);s&&(r=s),f==="replaceWith"?n.trigger("ajaxInclude",[r])[n.data("method")](r):n[n.data("method")](r).trigger("ajaxInclude",[r])}),u.onManualCall===!0&&(h(n),n.on("click","a",function(e){e.preventDefault()})),!i||r.matchMedia&&r.matchMedia(i).matches?a(n):i&&r.matchMedia&&u.onOrientationChange!==!1&&c(n,i)}),l(),this}})(jQuery);